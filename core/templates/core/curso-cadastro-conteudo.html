{% extends  'pagina-inicial.html' %}
{% block content_page %}
  <style>
        .icone {
            display:inline;
            text-align:center;
        }

        .fa-save {
            color: green;
            font-size: 1.5rem;
        }

        .fa-trash {
            color: red;
            font-size: 1.5rem;
        }

        .fa-save:hover {
            color: gray;
            cursor: pointer;
        }

        .fa-trash:hover {
            color: gray;
            cursor: pointer;
        }

        .btn-link {
            font-weight: bold;
            font-size: 1.0rem;
            cursor: pointer;
        }

        .disabledbutton {
            pointer-events: none;
            opacity: 0.4;
        }

        .btn-add-panel,
        .btn-add-panel1,
        .btn-add-panel-conteudo,
        .btn-add-alternativa {
            padding: .30rem .4rem;
            font-size: 1rem;
            //font-weight: bold;
            margin-top: 5px;
            margin-bottom: 5px;
        }

         .tab-content-body {
            margin-left: 10px;
            padding: 10px;
        }
        .tab-content {
            border-bottom: 1px solid #dee2e6;
            border-left: 1px solid #dee2e6;
            border-right: 1px solid #dee2e6;
        }

        .nav-tabs-content{
            border: 1px solid #dee2e6;
            background-color: #f8f9fa;
        }

        .nav-link-content {
            border: 1px solid gray !important;
            color: color: #007bff;;
            background-color: white;
            border-top-left-radius: 0 !important;
            border-top-right-radius: 0 !important;
            border-radius: .3rem !important;
            font-family: inherit !important;
            margin-right: 5px !important;
            margin-bottom: 5px !important;
            margin-top: 5px !important;
        }

        .nav-link-content.active {
            color: white !important;
            background-color: #007bff !important;
            border: 1px solid #007bff !important;
            border-top-left-radius: 0 !important;
            border-top-right-radius: 0 !important;
            border-radius: .3rem !important;
            font-family: inherit !important;
        }

        .nav-link-content.active > i{
            color: white !important;
        }


        .form-group {
            margin-top: 5px;
        }

        .fa-angle-double-down, .fa-angle-double-up{
          margin-right: 0.5rem;
        }

       .bd-example-modal-lg .modal-dialog{
          display: table;
          position: relative;
          margin: 0 auto;
          top: calc(50% - 24px);
        }

        .bd-example-modal-lg .modal-dialog .modal-content{
          background-color: transparent;
          border: none;
        }

        .card {
            margin-bottom: 5px;
        }

        .card-body {
            padding: 0.5rem;
        }

        .card-header {
            padding: .04rem 1rem
        }

        .class-icone-content {
            margin-right: 10px;
            color: #007bff;
        }

        .class-icone-button{
            margin-right: 10px;
            color: white;
        }

        .btn-link {
           font-weight: bold;
        }

  </style>

    <div class="alert alert-secondary" role="alert" style="background-color: rgba(0,0,0,.03); padding: 0;">
        <h2 class="text-center" style="margin-top: 5px;">Cadastro de conteúdos: {{ curso.titulo }}</h2>
    </div>

    <div class="alert alert-secondary" role="alert" style="background-color: rgba(0,0,0,.03); padding: 0;">
        <p class="text-center" style="margin-top: 10px;">Cadastrar abaixo o conteúdo didático do curso agrupando-os em Unidades contendo Vídeos, Arquivos e Questionáticos com questões de multiplas escolhas.</p>
    </div>


    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
        <div class="col text-center" style="margin-top: 10px; margin-bottom: 10px; padding: 0;">
             <button class="btn btn-primary btn-add-panel" title="Cria uma nova unidade"><i class="fa fa-plus" style="vertical-align: middle;"></i> Adicionar Unidade</button>
        </div>
    </div>

   <div id="accordion">
   {% for unidade in unidades %}

    <div class="panel-group" id="accordion-{{ unidade.ordem }}">
        <div class="card card-unidade unidade" id="unidade-{{ unidade.ordem }}">
          <div class="card-header" id="heading{{ unidade.ordem }}" style="text-align-last: justify;">
            <h5 class="mb-0">

              <div class="btn btn-link link-unidade" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse{{ unidade.ordem }}" title="Clique aqui para exibir ou omitir detalhes da unidade">
                  Unidade - {{ unidade.ordem }}
              </div>

              <div class="icone">
                  <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                      <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                  </div>
              </div>

              <div class="icone">
                <div class="btn"  style="float:right; font-size: 1rem" title="Exclui unidade">
                  <i class="fa fa-trash fa-1x" id="elimina-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'unidade', {{ unidade.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                </div>
              </div>

            </h5>
          </div>
          <div id="collapse{{ unidade.ordem }}" class="collapse" aria-labelledby="heading{{ unidade.ordem }}" data-parent="#accordion-{{ unidade.ordem }}" style="padding: 10px;">

            <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-unidade-{{ unidade.ordem }}">

                <div class="resultado-unidade" id="resultado-unidade-{{ unidade.ordem }}"></div>

                {% csrf_token %}

                <input type="hidden" name="conteudo_id"   value="{{ unidade.id }}">
                <input type="hidden" name="conteudo_tipo" value="unidade">
                <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">

                <div class="form-group">
                    <label for="titulo-unidade" id="label-unidade">Titulo:</label>
                    <input type="text" class="form-control" id="titulo-unidade" value="{{ unidade.titulo }}" aria-describedby="" placeholder="Digite um título" name="titulo-unidade">
                    <span id="titulo-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                </div>

                <div class="form-group">
                    <label for="descricao-unidade" id="label-descricao">Descrição:</label>
                    <input type="text" class="form-control" id="descricao-unidade" value="{{ unidade.descricao }}" aria-describedby="" placeholder="Digite uma descrição" name="descricao-unidade">
                </div>

            </form>

            <!-- <ul class="nav nav-tabs" id="navegacao-unidade" role="tablist"> -->
            <ul class="nav nav-tabs nav-tabs-content justify-content-center" id="navegacao-curso" role="tablist">
                <li class="nav-item">
                    <a class="nav-link nav-link-content active" id="videos-tab" data-toggle="tab" href="#videos-unidade-{{ unidade.ordem }}" role="tab" aria-controls="videos-unidade-{{ unidade.ordem }}" aria-selected="true" title="Cadastro de vídeos da unidade">
                        <i class="fas fa-video class-icone-content"></i>Vídeos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-content" id="arquivos-tab" data-toggle="tab" href="#arquivos-unidade-{{ unidade.ordem }}" role="tab" aria-controls="arquivos-unidade-{{ unidade.ordem }}" aria-selected="false" title="Cadastro de arquivos da unidade">
                        <i class="fas fa-file-alt class-icone-content"></i>Arquivos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-content" id="questionarios-tab" data-toggle="tab" href="#questionarios-unidade-{{ unidade.ordem }}" role="tab" aria-controls="questionarios-unidade-{{ unidade.ordem }}" aria-selected="false" title="Cadastro de questionários da unidade">
                        <i class="fas fa-tasks class-icone-content"></i>Questionários
                    </a>
                </li>
            </ul>

            <div class="tab-content" id="navegacao-conteudo">

            <div class="tab-pane fade show active" id="videos-unidade-{{ unidade.ordem }}" role="tabpanel" aria-labelledby="videos-tab">
                <div class="card-body  accordion-videos-unidade-{{ unidade.ordem }} card-videos">

                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                            <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-videos-unidade-{{ unidade.ordem }}" onclick='adicionaConteudo(this, "video")' title="Cria um novo vídeo">
                                <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo vídeo
                            </button>
                        </div>
                    </div>

                    {% for video in videos %}
                        {% if video.unidade.id == unidade.id %}

                        <div class="card card-video-{{ video.ordem }}-unidade-{{ unidade.ordem }} video" id="video-{{ video.ordem }}-unidade-{{ unidade.ordem }}">

                            <div class="card-header" id="heading-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}" style="text-align-last: justify;">
                                <h5 class="mb-0">

                                    <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}" title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                                        Vídeo - {{ video.ordem }}
                                    </div>

                                    <div class="icone">
                                        <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                            <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                                        </div>
                                    </div>

                                    <div class="icone">
                                      <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                        <i class="fa fa-trash fa-1x" id="elimina-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'video', {{ video.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                                      </div>
                                    </div>

                                </h5>
                            </div>

                            <div id="collapse-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}" class="collapse" aria-labelledby="heading-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}" data-parent="#accordion-videos-unidade-{{ unidade.ordem }}">
                                <div class="card-body  accordion-video-{{ video.ordem  }}-unidade-{{ unidade.ordem }}">
                                    <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}">

                                        <div class="resultado-video" id="resultado-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}"></div>

                                        {% csrf_token %}

                                        <input type="hidden" name="conteudo_id" value="{{ video.id }}">
                                        <input type="hidden" name="conteudo_tipo" value="video">
                                        <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">
                                        <input type="hidden" name="conteudo_ordem" value="{{ video.ordem }}">
                                        <input type="hidden" name="path_arquivo" value="{{ video.caminho }}">

                                        <div class="form-group">
                                            <label for="titulo-conteudo" id="label-titulo">Titulo:</label>
                                            <input type="text" class="form-control" id="titulo-conteudo" value="{{ video.titulo  }}" aria-describedby="" placeholder="Digite um título" name="titulo">
                                            <span id="titulo-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                        </div>

                                        <div class="form-check">
                                            <label class="form-check-label">
                                                {% if video.video_interno == False %}
                                                    <input type="radio" class="form-check-input" id="tipo-video-url" value="url" name="tipo-video" checked>Vídeo - URL
                                                {% else %}
                                                    <input type="radio" class="form-check-input" id="tipo-video-url" value="url" name="tipo-video">Vídeo - URL
                                                {% endif %}
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <label class="form-check-label">
                                                {% if video.video_interno == True %}
                                                    <input type="radio" class="form-check-input" id="tipo-video-arquivo" value="arquivo" name="tipo-video" checked>Vídeo - Arquivo
                                                {% else %}
                                                    <input type="radio" class="form-check-input" id="tipo-video-arquivo" value="arquivo" name="tipo-video">Vídeo - Arquivo
                                                {% endif %}
                                            </label>
                                        </div>

                                        {% if video.video_interno == False %}

                                            <div class="form-group grupo-url">
                                                <label for="conteudo-url" id="label-url">URL:</label>
                                                {% if video.url != None %}
                                                <input type="url" class="form-control" id="conteudo-url" value="{{ video.url  }}" placeholder="Digite uma URL" name="url">
                                                {% else %}
                                                <input type="url" class="form-control" id="conteudo-url" placeholder="Digite uma URL" name="url">
                                                {% endif %}
                                                <span id="url-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                            </div>

                                            <div class="form-group grupo-arquivo" hidden="true">
                                                <label for="conteudo-path" id="label-path">Arquivo:</label>
                                                <span><a class="caminho-arquivo-span" href="/media/{{ video.caminho }}" target="_blank" id="link-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}"> {{ video.caminho }}</a></span>
                                                <input type="file" class="form-control" id="conteudo-path" name="caminho">
                                                <span id="path-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                            </div>

                                        {% else %}

                                            <div class="form-group grupo-url" hidden="true">
                                                <label for="conteudo-url" id="label-url">URL:</label>
                                                <input type="url" class="form-control" id="conteudo-url" value="{{ video.url  }}" placeholder="Digite uma URL" name="url">
                                                <span id="url-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                            </div>

                                            <div class="form-group grupo-arquivo">
                                                <label for="conteudo-path" id="label-path">Arquivo:</label>
                                                <span><a class="caminho-arquivo-span" href="/media/{{ video.caminho }}" target="_blank" id="link-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}"> {{ video.caminho }}</a></span>
                                                <input type="file" class="form-control" id="conteudo-path" name="caminho">
                                                <span id="path-video-{{ video.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                            </div>

                                        {% endif %}

                                    </form>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <div class="tab-pane fade" id="arquivos-unidade-{{ unidade.ordem }}" role="tabpanel" aria-labelledby="arquivos-tab">
                <div class="card-body  accordion-arquivos-unidade-{{ unidade.ordem }} card-arquivos">

                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                            <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-arquivos-unidade-{{ unidade.ordem }}" onclick='adicionaConteudo(this, "arquivo")' title="Cria um novo arquivo">
                                <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo arquivo
                            </button>
                        </div>
                    </div>
                    {% for arquivo in arquivos %}
                        {% if arquivo.unidade.id == unidade.id %}

                        <div class="card card-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }} arquivo" id="arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}">

                            <div class="card-header" id="heading-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}" style="text-align-last: justify;">
                                <h5 class="mb-0">

                                    <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                                        Arquivo - {{ arquivo.ordem }}
                                    </div>

                                    <div class="icone">
                                        <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                            <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                                        </div>
                                    </div>

                                    <div class="icone">
                                      <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                        <i class="fa fa-trash fa-1x" id="elimina-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'arquivo', {{ arquivo.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                                      </div>
                                    </div>

                                </h5>
                            </div>

                            <div id="collapse-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}" class="collapse" aria-labelledby="heading-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}" data-parent="#accordion-arquivos-unidade-{{ unidade.ordem }}">
                                <div class="card-body  accordion-arquivo-{{ arquivo.ordem  }}-unidade-{{ unidade.ordem }}">
                                    <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}">

                                        <div class="resultado-arquivo" id="resultado-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}"></div>

                                        {% csrf_token %}

                                        <input type="hidden" name="conteudo_id" value="{{ arquivo.id }}">
                                        <input type="hidden" name="conteudo_tipo" value="arquivo">
                                        <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">
                                        <input type="hidden" name="conteudo_ordem" value="{{ arquivo.ordem }}">
                                        <input type="hidden" name="path_arquivo" value="{{ arquivo.caminho }}">

                                        <div class="form-group">
                                            <label for="titulo-conteudo" id="label-titulo">Titulo:</label>
                                            <input type="text" class="form-control" id="titulo-conteudo" value="{{ arquivo.titulo  }}" aria-describedby="" placeholder="Digite um título" name="titulo">
                                            <span id="titulo-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                        </div>

                                        <div class="form-group">
                                            <label for="conteudo-path" id="label-path">Arquivo:</label>
                                            <span><a class="caminho-arquivo-span" href="/media/{{ arquivo.caminho }}" target="_blank" id="link-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}"> {{ arquivo.caminho }}</a></span>
                                            <input type="file" class="form-control" id="conteudo-path" placeholder="Selecione um caminho" name="caminho">
                                            <span id="path-arquivo-{{ arquivo.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <div class="tab-pane fade" id="questionarios-unidade-{{ unidade.ordem }}" role="tabpanel" aria-labelledby="questionarios-tab">
                <div class="card-body  accordion-questionarios-unidade-{{ unidade.ordem }} card-questionarios">

                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                            <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-questionarios-unidade-{{ unidade.ordem }}" onclick='adicionaConteudo(this, "questionario")' title="Cria um novo questionário">
                                <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo questionário
                            </button>
                        </div>
                    </div>
                    {% for questionario in questionarios %}
                        {% if questionario.unidade.id == unidade.id %}

                        <div class="card card-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} questionario" id="questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">

                            <div class="card-header" id="heading-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}" style="text-align-last: justify;">
                                <h5 class="mb-0">

                                    <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                                        Questionário - {{ questionario.ordem }}
                                    </div>

                                    <div class="icone">
                                        <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                            <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                                        </div>
                                    </div>

                                    <div class="icone">
                                      <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                        <i class="fa fa-trash fa-1x" id="elimina-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'questionario', {{ questionario.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                                      </div>
                                    </div>

                                </h5>
                            </div>

                            <div id="collapse-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}" class="collapse" aria-labelledby="heading-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}" data-parent="#accordion-questionarios-unidade-{{ unidade.ordem }}">
                                <div class="card-body  accordion-questionario-{{ questionario.ordem  }}-unidade-{{ unidade.ordem }}">
                                    <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                        <div class="resultado-questionario" id="resultado-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}"></div>

                                        {% csrf_token %}

                                        <input type="hidden" name="conteudo_id" value="{{ questionario.id }}">
                                        <input type="hidden" name="conteudo_tipo" value="questionario">
                                        <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">
                                        <input type="hidden" name="conteudo_ordem" value="{{ questionario.ordem }}">
                                        <input type="hidden" name="path_arquivo" value="">

                                        <div class="form-group">
                                            <label for="titulo-conteudo" id="label-titulo">Titulo:</label>
                                            <input type="text" class="form-control" id="titulo-conteudo" value="{{ questionario.titulo  }}" aria-describedby="" placeholder="Digite um título" name="titulo">
                                            <span id="titulo-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>
                                        </div>

                                    </form>

                                    <div class="card-body accordion-questoes-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} card-questoes" style="padding: 0;">

                                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                                            <div class="col text-center" style="margin-top: 10px; margin-bottom: 10px; padding: 0;">
                                                <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-questoes-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" onclick='adicionaQuestoes(this, {{ questionario.ordem }}, {{ unidade.ordem }})'  title="Cria uma nova questão">
                                                    <i class="fa fa-plus" style="vertical-align: middle;"></i> Adicionar Questão
                                                </button>
                                            </div>
                                        </div>

                                        {% for questao in questoes %}
                                            {% if questao.questionario.id == questionario.id %}
                                            <div class="card card-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} questao" id="questao-0-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">

                                                <div class="card-header" id="heading-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" style="text-align-last: justify;">
                                                    <h5 class="mb-0">

                                                        <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                                                            Questão - {{ questao.ordem }}
                                                        </div>

                                                        <div class="icone">
                                                            <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                                                <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                                                            </div>
                                                        </div>

                                                        <div class="icone">
                                                            <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                                                <i class="fa fa-trash fa-1x" id="elimina-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'questao', {{ questao.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                                                            </div>
                                                        </div>

                                                    </h5>
                                                </div>

                                                <div id="collapse-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" class="collapse" aria-labelledby="heading-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" data-parent="#accordion-questoes-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                                    <div class="card-body  accordion-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                                        <form id="form-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">

                                                            <div class="resultado-questao" id="resultado-questao-0-questionario-0-unidade-0"></div>

                                                            {% csrf_token %}

                                                            <input type="hidden" name="conteudo_id" value="{{ questao.id }}">
                                                            <input type="hidden" name="conteudo_tipo" value="questao">
                                                            <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">
                                                            <input type="hidden" name="questionario_ordem" value="{{ questionario.ordem }}">
                                                            <input type="hidden" name="questao_ordem" value="0">

                                                            <div class="form-group">
                                                                <label for="titulo-questao" id="label-questao">Enunciado:</label>
                                                                <input type="text" class="form-control" id="titulo-questao" value="{{ questao.enunciado }}" aria-describedby="" placeholder="Digite um enunciado" name="questao">
                                                                <span id="titulo-questao-0-questionario-0-unidade-0" style="color: red;"></span>
                                                            </div>

                                                        </form>
                                                        <div class="card-body  accordion-alternativas-questao-0-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} card-alternativas" style="padding: 0;">

                                                            <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                                                                <div class="col text-center" style="margin-top: 10px; margin-bottom: 10px; padding: 0;">
                                                                    <button class="btn btn-primary btn-add-alternativa" id="accordion-alternativas-questao-0-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" onclick='adicionaAlternativas(this, {{ questionario.ordem }}, {{ unidade.ordem }})' title="Cria uma nova alternativa">
                                                                        <i class="fa fa-plus" style="vertical-align: middle;"></i> Adicionar Alternativa
                                                                    </button>
                                                                </div>
                                                            </div>

                                                            {% for alternativa in alternativas %}
                                                                {% if alternativa.questao.id == questao.id %}
                                                                <div class="card card-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} alternativa" id="alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">

                                                                    <div class="card-header" id="heading-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" style="text-align-last: justify;">
                                                                        <h5 class="mb-0">

                                                                            <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" aria-expanded="true" aria-controls="collapse-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                                                                                Alternativa - 0
                                                                            </div>

                                                                            <div class="icone">
                                                                                <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                                                                    <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                                                                                </div>
                                                                            </div>

                                                                            <div class="icone">
                                                                                <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                                                                    <i class="fa fa-trash fa-1x" id="elimina-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" onclick="removeCard(this, 'alternativa', {{ alternativa.id }})" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                                                                                </div>
                                                                            </div>

                                                                        </h5>
                                                                    </div>

                                                                    <div id="collapse-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" class="collapse" aria-labelledby="heading-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }} data-parent="#accordion-alternativas-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                                                        <div class="card-body  accordion-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                                                            <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}">
                                                                                <div class="resultado-alternativa" id="resultado-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}"></div>

                                                                                {% csrf_token %}

                                                                                <input type="hidden" name="conteudo_id" value="{{ alternativa.id }}">
                                                                                <input type="hidden" name="conteudo_tipo" value="alternativa">
                                                                                <input type="hidden" name="unidade_ordem" value="{{ unidade.ordem }}">
                                                                                <input type="hidden" name="questionario_ordem" value="{{ questionario.ordem }}">
                                                                                <input type="hidden" name="questao_ordem" value="{{ questao.ordem }}">
                                                                                <input type="hidden" name="alternativa_ordem" value="{{ alternativa.ordem }}">

                                                                                <label for="titulo-alternativa" id="label-alternativa">Descrição:</label>
                                                                                <div class="input-group mb-3">
                                                                                  <div class="input-group-prepend">
                                                                                    <div class="input-group-text">
                                                                                      {% if alternativa.correta == True %}
                                                                                          <input type="checkbox" aria-label="" name="alternativa-correta" checked title="Marque para indicar que está alternativa é a correta">&nbspCorreta
                                                                                      {% else %}
                                                                                          <input type="checkbox" aria-label="" name="alternativa-correta" title="Marque para indicar que está alternativa é a correta">&nbspCorreta
                                                                                      {% endif %}
                                                                                    </div>
                                                                                  </div>
                                                                                  <input type="text" class="form-control" id="titulo-alternativa" value="{{ alternativa.descricao }} "aria-describedby="" placeholder="Digite uma resposta" name="alternativa">
                                                                                </div>
                                                                                <span id="titulo-alternativa-{{ alternativa.ordem }}-questao-{{ questao.ordem }}-questionario-{{ questionario.ordem }}-unidade-{{ unidade.ordem }}" style="color: red;"></span>

                                                                            </form>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                {% endif %}
                                                            {% endfor %}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {% endif %}
                                        {% endfor %}

                                    </div>

                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            </div>
          </div>
        </div>
    </div>
    {% endfor %}

    </div>

<div class="modal fade bd-example-modal-lg modal-aguarde" data-backdrop="static" data-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content" style="width: 48px">
            <span class="fa fa-spinner fa-spin fa-3x"></span>
            <span><b>Aguarde...</b></span>
        </div>
    </div>
</div>


<div class="modal modal-sem-alteracoes" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cadastro de conteúdo de Curso</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Não existem alterações a serem salvas.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade modal-delete-item" id="confirmDeleteModal" id_elemento="" id_conteudo="" classe_elemento="" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body confirm-delete">
        Deseja realmente remover o item?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancela</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" id="confirmDeleteButtonModal">Remove</button>
      </div>
    </div>
  </div>
</div>


  <script>

    var numero_unidade  = 1;
    var numero_questao = 1;
    var hash1 = 1;
    var hash2 = 1;
    var hash3 = 1;
    var tipo_conteudo_video        = 0
    var tipo_conteudo_arquivo      = 1
    var tipo_conteudo_questionario = 2

    $(".btn-add-panel").on("click", function () {

        $("#accordion").append(
         `
            <div class="panel-group" id="accordion-${numero_unidade}">
            <div class="card card-unidade unidade" id="unidade-${numero_unidade}">
              <div class="card-header" id="heading${numero_unidade}" style="text-align-last: justify;">
                <h5 class="mb-0">

                  <div class="btn btn-link link-unidade" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse${numero_unidade}" aria-expanded="true" aria-controls="collapse${numero_unidade}" title="Clique aqui para exibir ou omitir detalhes da unidade">
                      Unidade - ${numero_unidade}
                  </div>

                  <div class="icone">
                      <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                          <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                      </div>
                  </div>

                  <div class="icone">
                    <div class="btn"  style="float:right; font-size: 1rem" title="Exclui unidade" title="Exclui conteúdo">
                      <i class="fa fa-trash fa-1x" id="elimina-unidade-0" onclick="removeCard(this, 'unidade', 0)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                    </div>
                  </div>

                </h5>
              </div>
              <div id="collapse${numero_unidade}" class="collapse show" aria-labelledby="heading${numero_unidade}" data-parent="#accordion-${numero_unidade}" style="padding: 10px;">

                <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-unidade-0">

                    <div class="resultado-unidade" id="resultado-unidade-{{ unidade.ordem }}"></div>

                    {% csrf_token %}

                    <input type="hidden" name="conteudo_id" value="0">
                    <input type="hidden" name="curso_id" value="0">
                    <input type="hidden" name="conteudo_tipo" value="unidade">
                    <input type="hidden" name="unidade_ordem" value="${numero_unidade}">

                    <div class="form-group">
                        <label for="titulo-unidade" id="label-unidade">Titulo:</label>
                        <input type="text" class="form-control" id="titulo-unidade" aria-describedby="" placeholder="Digite um título" name="titulo-unidade">
                        <span id="titulo-unidade-${numero_unidade}" style="color: red;"></span>
                    </div>

                    <div class="form-group">
                        <label for="descricao-unidade" id="label-descricao">Descrição:</label>
                        <input type="text" class="form-control" id="descricao-unidade" aria-describedby="" placeholder="Digite uma descrição" name="descricao-unidade">
                    </div>

                </form>

                <ul class="nav nav-tabs nav-tabs-content justify-content-center" id="navegacao-curso" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link nav-link-content active" id="videos-tab" data-toggle="tab" href="#videos-unidade-${numero_unidade}" role="tab" aria-controls="videos-unidade-${numero_unidade}" aria-selected="true" title="Cadastro de vídeos da unidade">
                            <i class="fas fa-video class-icone-content"></i>Vídeos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-content " id="arquivos-tab" data-toggle="tab" href="#arquivos-unidade-${numero_unidade}" role="tab" aria-controls="arquivos-unidade-${numero_unidade}" aria-selected="false" title="Cadastro de arquivos da unidade">
                            <i class="fas fa-file-alt class-icone-content"></i>Arquivos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-content " id="questionarios-tab" data-toggle="tab" href="#questionarios-unidade-${numero_unidade}" role="tab" aria-controls="questionarios-unidade-${numero_unidade}" aria-selected="false" title="Cadastro de questionários da unidade">
                            <i class="fas fa-tasks class-icone-content"></i>Questionários
                        </a>
                    </li>
                </ul>

                <div class="tab-content" id="navegacao-conteudo">

                <div class="tab-pane fade show active" id="videos-unidade-${numero_unidade}" role="tabpanel" aria-labelledby="videos-tab">
                    <div class="card-body  accordion-videos-unidade-${numero_unidade} card-videos">

                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                                <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-videos-unidade-${numero_unidade}" onclick='adicionaConteudo(this, "video")' title="Cria um novo vídeo">
                                    <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo vídeo
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="tab-pane fade" id="arquivos-unidade-${numero_unidade}" role="tabpanel" aria-labelledby="arquivos-tab">
                    <div class="card-body  accordion-arquivos-unidade-${numero_unidade} card-arquivos">

                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                                <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-arquivos-unidade-${numero_unidade}" onclick='adicionaConteudo(this, "arquivo")' title="Cria um novo arquivo">
                                    <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo arquivo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="questionarios-unidade-${numero_unidade}" role="tabpanel" aria-labelledby="questionarios-tab">
                    <div class="card-body  accordion-questionarios-unidade-${numero_unidade} card-questionarios">

                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="col text-center" style="margin-top: 0px; margin-bottom: 10px; padding: 0;">
                                <button class="btn btn-primary btn-add-panel-conteudo" id="accordion-questionarios-unidade-${numero_unidade}" onclick='adicionaConteudo(this, "questionario")' title="Cria um novo questionário">
                                    <i class="fa fa-plus" style="vertical-align: middle;"></i> Novo questionário
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                </div>
              </div>
            </div>
         `
        );

        $('form').on('submit', enviaForm);
        $('input').on('focus', removeErro)
        $('input').on('change', alterouDados)

        organizaUnidadesConteudos()
    });

    function adicionaConteudo(elemento, tipo_conteudo) {
        unidade_id = elemento.id;

        var unidade = unidade_id.substring(unidade_id.length-1, unidade_id.length)

        var tipo_conteudo_atual  = 0
        var titulo_card = ""
        if(tipo_conteudo == "video"){
            $("." + elemento.id).on("click", ordenaConteudo);
            tipo_conteudo_atual = tipo_conteudo_video
            titulo_card = "Vídeo"
        }

        if(tipo_conteudo == "arquivo"){
            $("." + elemento.id).on("click", ordenaConteudoArquivo);
            tipo_conteudo_atual = tipo_conteudo_arquivo
            titulo_card = "Arquivo"
        }

        if(tipo_conteudo == "questionario"){
            $("." + elemento.id).on("click", ordenaConteudoQuestionario);
            tipo_conteudo_atual = tipo_conteudo_questionario
            titulo_card = "Questionário"
        }

        $("." + unidade_id).append(
            `
            <div class="card card-${tipo_conteudo}-0-unidade-${unidade} ${tipo_conteudo}" id="${tipo_conteudo}-0-unidade-${unidade}">

                <div class="card-header" id="heading${hash1}b" style="text-align-last: justify;">
                    <h5 class="mb-0">

                        <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse${hash1}b" aria-expanded="true" aria-controls="collapse${hash1}b"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                            ${titulo_card} - 0
                        </div>

                        <div class="icone">
                            <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                            </div>
                        </div>

                        <div class="icone">
                          <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                            <i class="fa fa-trash fa-1x" id="elimina-${tipo_conteudo}-0-unidade-${unidade}" onclick="removeCard(this, '${tipo_conteudo}', 0)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                          </div>
                        </div>
                    </h5>
                </div>

                <div id="collapse${hash1}b" class="collapse show" aria-labelledby="heading${hash1}b" data-parent="#${unidade_id}">
                    <div class="card-body  accordion${hash1}b">
                        <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-${tipo_conteudo}-0-unidade-${unidade}">

                            <div class="resultado-${tipo_conteudo}" id="resultado-${tipo_conteudo}-0-unidade-${unidade}"></div>

                            {% csrf_token %}

                            <input type="hidden" name="conteudo_id" value="0">
                            <input type="hidden" name="conteudo_tipo" value="${tipo_conteudo}"">
                            <input type="hidden" name="unidade_ordem" value="${unidade}">
                            <input type="hidden" name="conteudo_ordem" value="0">
                            <input type="hidden" name="path_arquivo" value="">

                            <div class="form-group">
                                <label for="titulo-conteudo" id="label-titulo">Titulo:</label>
                                <input type="text" class="form-control" id="titulo-conteudo" aria-describedby="" placeholder="Digite um título" name="titulo">
                                <span id="titulo-${tipo_conteudo}-0-unidade-${unidade}" style="color: red;"></span>
                            </div>

                            <div class="form-check">
                                <label class="form-check-label" id="check-video-url">
                                    <input type="radio" class="form-check-input" id="tipo-video-url" value="url" name="tipo-video" checked>Vídeo - URL
                                </label>
                            </div>
                            <div class="form-check" id="check-video-arquivo">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input" id="tipo-video-arquivo" value="arquivo" name="tipo-video">Vídeo - Arquivo
                                </label>
                            </div>

                            <div class="form-group grupo-url">
                                <label for="conteudo-url" id="label-url">URL: </label>
                                <input type="url" class="form-control" id="conteudo-url" placeholder="Digite uma URL" name="url">
                                <span id="url-${tipo_conteudo}-0-unidade-${unidade}" style="color: red;"></span>
                            </div>

                            <div class="form-group grupo-arquivo" hidden="true">
                                <label for="conteudo-path" id="label-path">Arquivo:</label>
                                <span><a class="caminho-arquivo-span" href="" target="_blank" id="link-conteudo-0-unidade-0"></a></span>
                                <input type="file" class="form-control" id="conteudo-path" placeholder="Selecione um caminho" name="caminho">
                                <span id="path-${tipo_conteudo}-0-unidade-${unidade}" style="color: red;"></span>
                            </div>

                        </form>
                        <div class="card-body  accordion-questoes-questionario-0-unidade-${numero_unidade - 1} card-questoes" style="padding: 0;">

                            <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                                <div class="col text-center" style="margin-top: 10px; margin-bottom: 10px; padding: 0;">
                                    <button class="btn btn-primary btn-add-panel1" id="accordion-questoes-questionario-0-unidade-${numero_unidade - 1}" onclick='adicionaQuestoes(this, 0, ${(numero_unidade - 1)})'  title="Cria uma nova questão">
                                        <i class="fa fa-plus" style="vertical-align: middle;"></i> Adicionar Questão
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
              `
        );
        var classe_card_conteudo = 'card-' + tipo_conteudo + '-' + 0 + '-unidade-' + unidade

        var label_titulo  = $('.' + classe_card_conteudo).find('#label-titulo')[0]
        var input_titulo  = $('.' + classe_card_conteudo).find('input[name="titulo"]')[0]
        var label_url     = $('.' + classe_card_conteudo).find('#label-url')[0]
        var input_url     = $('.' + classe_card_conteudo).find('input[name="url"]')[0]
        var grupo_arquivo = $('.' + classe_card_conteudo).find('.grupo-arquivo')[0]

        var check_video_url   = $('.' + classe_card_conteudo).find('#check-video-url')[0]
        var check_video_arquivo   = $('.' + classe_card_conteudo).find('#check-video-arquivo')[0]

        var div_questoes = $('.' + "accordion-questoes-questionario-" + 0 + "-unidade-" +  (numero_unidade - 1))[0]

        if(tipo_conteudo == "video"){
            div_questoes.remove()
        }

        if(tipo_conteudo == "arquivo"){
            if(label_url)
               label_url.hidden  = true
            if(input_url)
               input_url.hidden  = true
            if(grupo_arquivo)
                grupo_arquivo.hidden = false
            if(div_questoes)
                div_questoes.remove()
            if(check_video_url)
                check_video_url.hidden  = true
            if(check_video_arquivo)
                check_video_arquivo.hidden  = true
        }

        if(tipo_conteudo == "questionario"){
            if(label_url)
                label_url.hidden  = true
            if(input_url)
                input_url.hidden  = true
            if(grupo_arquivo)
                grupo_arquivo.hidden = true
            if(check_video_url)
                check_video_url.hidden  = true
            if(check_video_arquivo)
                check_video_arquivo.hidden  = true
        }

        $('form').on('submit', enviaForm);
        $('input').on('focus', removeErro)
        $('input').on('change', alterouDados)
        $('input:file').on('change', alterouArquivo)

        organizaUnidadesConteudos();
    }


    function adicionaQuestoes(elemento, numero_questionario, numero_unidade){

        $('.' + elemento.id).append(
        `
            <div class="card card-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade} questao" id="questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}">

                <div class="card-header" id="heading${hash2}c" style="text-align-last: justify;">
                    <h5 class="mb-0">

                        <div class="btn btn-link link-conteudo" onclick="expandeArea(this)"data-toggle="collapse" data-target="#collapse${hash2}c" aria-expanded="true" aria-controls="collapse${hash2}c"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                            Questão - 0
                        </div>

                        <div class="icone">
                            <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                            </div>
                        </div>

                        <div class="icone">
                            <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                <i class="fa fa-trash fa-1x" id="elimina-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}" onclick="removeCard(this, 'questao', 0)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                            </div>
                        </div>
                    </h5>
                </div>

                <div id="collapse${hash2}c" class="collapse show" aria-labelledby="heading${hash2}c" data-parent="#${elemento.id}">
                    <div class="card-body  accordion${hash2}c">
                        <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}">

                            <div class="resultado-questao" id="resultado-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}"></div>
                            {% csrf_token %}

                            <input type="hidden" name="conteudo_id" value="0">
                            <input type="hidden" name="conteudo_tipo" value="questao">
                            <input type="hidden" name="unidade_ordem" value="${numero_unidade}">
                            <input type="hidden" name="questionario_ordem" value="${numero_questionario}">
                            <input type="hidden" name="questao_ordem" value="0">

                            <div class="form-group">
                                <label for="titulo-questao" id="label-questao">Enunciado:</label>
                                <input type="text" class="form-control" id="titulo-questao" aria-describedby="" placeholder="Digite um enunciado" name="questao">
                                <span id="titulo-questao-0-questionario-0-unidade-0" style="color: red;"></span>
                            </div>

                        </form>
                        <div class="card-body  accordion-alternativas-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade} card-alternativas" style="padding: 0;">

                            <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                                <div class="col text-center" style="margin-top: 10px; margin-bottom: 10px; padding: 0;">
                                    <button class="btn btn-primary btn-add-alternativa" id="accordion-alternativas-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}" onclick='adicionaAlternativas(this, ${numero_questionario}, ${(numero_unidade)})'  title="Cria uma nova alternativa">
                                        <i class="fa fa-plus" style="vertical-align: middle;"></i> Adicionar Alternativa
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        `
        );

        $('form').on('submit', enviaForm);
        $('input').on('focus', removeErro)
        $('input').on('change', alterouDados)

        $("." + elemento.id).on("click", ordenaConteudoQuestao);

        organizaUnidadesConteudos()
    }

    function adicionaAlternativas(elemento, numero_questionario, numero_unidade){

        $('.' + elemento.id).append(
        `
            <div class="card card-alternativa-0-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade} alternativa" id="alternativa-0-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}">

                <div class="card-header" id="heading${hash3}d" style="text-align-last: justify;">
                    <h5 class="mb-0">

                        <div class="btn btn-link link-conteudo" onclick="expandeArea(this)" data-toggle="collapse" data-target="#collapse${hash3}d" aria-expanded="true" aria-controls="collapse${hash3}d"  title="Clique aqui para exibir ou omitir detalhes do conteúdo">
                            Alternativa - 0
                        </div>

                        <div class="icone">
                            <div class="btn" style="font-size: 1rem" title="Persiste as alterações realizadas na página">
                                <i class="fa fa-save fa-1x" onclick="enviaForm(event)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Salvar</strong></i>
                            </div>
                        </div>

                        <div class="icone">
                            <div class="btn"  style="float:right; font-size: 1rem" title="Exclui conteúdo">
                                <i class="fa fa-trash fa-1x" id="elimina-alternativa-0-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}" onclick="removeCard(this, 'alternativa', 0)" style="margin-left: 10px;"><strong style="margin-left: 5px; font-size: 1.1rem; font-weight: bold">Excluir</strong></i>
                            </div>
                        </div>
                    </h5>
                </div>

                <div id="collapse${hash3}d" class="collapse show" aria-labelledby="heading${hash3}d" data-parent="#${elemento.id}">
                    <div class="card-body  accordion${hash3}d">
                        <form action="/cadastro-conteudo-curso/{{ curso.id }}" method="POST" id="form-alternativa-0-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}">
                            <div class="resultado-alternativa" id="resultado-alternativa-0-questao-0-questionario-${numero_questionario}-unidade-${numero_unidade}"></div>

                            {% csrf_token %}

                            <input type="hidden" name="conteudo_id" value="0">
                            <input type="hidden" name="conteudo_tipo" value="alternativa">
                            <input type="hidden" name="unidade_ordem" value="${numero_unidade}">
                            <input type="hidden" name="questionario_ordem" value="${numero_questionario}">
                            <input type="hidden" name="questao_ordem" value="0">
                            <input type="hidden" name="alternativa_ordem" value="0">

                            <label for="titulo-alternativa" id="label-alternativa">Descrição:</label>
                            <div class="input-group mb-3">
                              <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <input type="checkbox" aria-label="" name="alternativa-correta" title="Marque para indicar que está alternativa é a correta">&nbspCorreta
                                </div>
                              </div>
                              <input type="text" class="form-control" id="titulo-alternativa" "aria-describedby="" placeholder="Digite uma resposta" name="alternativa">
                            </div>
                            <span id="titulo-alternativa-0-questao-0-questionario-0-unidade-0" style="color: red;"></span>

                        </form>
                    </div>
                </div>
            </div>
        `
        );

        $('form').on('submit', enviaForm);
        $('input').on('focus', removeErro)
        $('input').on('change', alterouDados)

        $("." + elemento.id).on("click", ordenaConteudoAlternativa);

        organizaUnidadesConteudos()
    }


    function organizaUnidadesConteudos(){
        cards_unidade = $(".card-unidade")
        numero_unidade  = 1;
        var numero_conteudo = 0;
        var titulo_secao = ""
        hash1 = 1;
        hash2 = 1;
        ordem_conteudo = [[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0]];
        for (let i = 0; i < cards_unidade.length; i++){

            numero_unidade = i + 1;

            cards_conteudo = $("#" + cards_unidade[i].id).find(".card");

            if($($($(cards_unidade[i]).find('.card-header')[0]).siblings()[0]).hasClass('show')){
                cards_unidade[i].getElementsByClassName("link-unidade")[0].innerHTML = '<i class="fas fa-angle-double-up"></i>Unidade - ' + (i + 1);
            }
            else {
                cards_unidade[i].getElementsByClassName("link-unidade")[0].innerHTML = '<i class="fas fa-angle-double-down"></i>Unidade - ' + (i + 1);
            }

            $(cards_unidade[i]).find('i')[2].id = "elimina-unidade-" + numero_unidade

            var form_unidade = $(cards_unidade[i]).find('form')[0]
            var form_novo_id  = "form-unidade-" + numero_unidade

            if(form_unidade.id != form_novo_id){
              form_unidade.id = form_novo_id
              $(form_unidade).addClass("dados-modificados")
            }

            $(form_unidade).find(".resultado-unidade")[0].id = "resultado-unidade-" + numero_unidade

            $(form_unidade).find('input[name="unidade_ordem"]')[0].value = numero_unidade

            $(cards_unidade[i]).find('span')[0].id ="titulo-unidade-" + numero_unidade

            $(cards_unidade[i]).find('.fa-trash').attr('onclick', "removeCard" + "(this, 'unidade', " + $(form_unidade).find('input[name="conteudo_id"]')[0].value + ")")

            for (let j = 0; j < cards_conteudo.length; j++){

                card_conteudo = cards_conteudo[j];

                var tipo_conteudo = ""
                var tipo_conteudo_id = 0;

                if($(card_conteudo).hasClass("video")) {
                    tipo_conteudo = "video"
                    tipo_conteudo_id = 0
                    titulo_secao = "Vídeo"
                }

                if($(card_conteudo).hasClass("arquivo")) {
                    tipo_conteudo = "arquivo"
                    tipo_conteudo_id = 1
                    titulo_secao = "Arquivo"
                }

                if($(card_conteudo).hasClass("questionario")) {
                    tipo_conteudo = "questionario"
                    tipo_conteudo_id = 2
                    titulo_secao = "Questionário"
                }

                if(tipo_conteudo != "") {
                    ordem_conteudo[numero_unidade][tipo_conteudo_id] = ordem_conteudo[numero_unidade][tipo_conteudo_id] + 1;

                    numero_conteudo = ordem_conteudo[numero_unidade][tipo_conteudo_id];

                    if($($($(card_conteudo).find('.card-header')[0]).siblings()[0]).hasClass('show')){
                        card_conteudo.getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-up"></i>'+ titulo_secao + " - " +  numero_conteudo;
                    }
                    else {
                        card_conteudo.getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-down"></i>'+ titulo_secao + " - " +  numero_conteudo;
                    }

                    card_conteudo.id = tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade;
                    $(card_conteudo).removeClass().addClass("card card-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade + " " + tipo_conteudo)

                    $(card_conteudo).find('i')[2].id = "elimina-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade

                    var form_conteudo = $(card_conteudo).find('form')[0]
                    var form_novo_id  = "form-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade

                    if(form_conteudo.id != form_novo_id){
                        form_conteudo.id = form_novo_id
                        $(form_conteudo).addClass("dados-modificados")
                        if($(form_conteudo).find('input:file')[0]){
                            //$(form_conteudo).find('input:file').addClass("trocou-arquivo")
                        }
                    }

                    $(card_conteudo).find('.fa-trash').attr('onclick', "removeCard" + "(this, '" + tipo_conteudo + "', "  + $(form_conteudo).find('input[name="conteudo_id"]')[0].value + ")")

                    $(card_conteudo).find('input[name="unidade_ordem"]')[0].value = numero_unidade
                    $(card_conteudo).find('input[name="conteudo_ordem"]')[0].value = numero_conteudo

                    $(card_conteudo).find('span')[0].id="titulo-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade

                    if($(card_conteudo).find('span')[1]){
                        $(card_conteudo).find('span')[1].id="url-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade
                    }

                    if($(card_conteudo).find('span')[2]){
                        if($(card_conteudo).find('span').find('a')[0]) {
                            $(card_conteudo).find('span').find('a')[0].id = "link-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade
                        }
                    }

                    if($(card_conteudo).find('span')[3]){
                        $(card_conteudo).find('span')[3].id="path-" + tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade
                    }

                    $(form_conteudo).find(".resultado-" + tipo_conteudo)[0].id = "resultado-"+ tipo_conteudo + "-" + numero_conteudo + "-unidade-" + numero_unidade

                    hash1 = hash1 + 1;

                    if(tipo_conteudo_id == 2) {
                        var questoes = $(card_conteudo).find(".questao" );
                        var questao = undefined;

                        for (let k = 0; k < questoes.length; k++){

                            questao = questoes[k]
                            numero_questao = k + 1

                            $(questao).removeClass().addClass("card card-questao-"+ numero_questao + "-questionario-" + numero_conteudo + "-unidade-" + numero_unidade + " questao")

                            if($($($(questao).find('.card-header')[0]).siblings()[0]).hasClass('show')){
                                $(questao)[0].getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-up"></i>Questão' + ' - ' +  numero_questao;
                            }
                            else {
                                $(questao)[0].getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-down"></i>Questão' + ' - ' +  numero_questao;
                            }

                            $(questao)[0].id = "questao-"+ numero_questao + "-questionario-" + numero_conteudo +"-unidade-"+ numero_unidade

                            $(questao).find('i')[2].id = "elimina-questao-"+ numero_questao + "-questionario-" + numero_conteudo +"-unidade-"+ numero_unidade

                            var form_questao = $(questao).find('form')[0]
                            var form_novo_id = "form-questao-" + numero_questao + "-questionario-" + numero_conteudo + "-unidade-" + numero_unidade
                            if(form_questao.id != form_novo_id){
                              form_questao.id = form_novo_id
                              $(form_questao).addClass("dados-modificados")
                            }

                            $(questao).find('.fa-trash').attr('onclick', "removeCard" + "(this, 'questao', "  + $(form_questao).find('input[name="conteudo_id"]')[0].value + ")")

                            $(questao).find('input[name="unidade_ordem"]')[0].value = numero_unidade
                            $(questao).find('input[name="questionario_ordem"]')[0].value = numero_conteudo
                            $(questao).find('input[name="questao_ordem"]')[0].value = numero_questao

                            $(questao).find('.card-alternativas').removeClass().addClass("card-body accordion-alternativas-questao-" + numero_questao + "-questionario-" + numero_conteudo + "-unidade-" + numero_unidade + " card-alternativas")
                            $(questao).find('.btn-add-alternativa')[0].id = "accordion-alternativas-questao-" + numero_questao + "-questionario-" + numero_conteudo + "-unidade-" + numero_unidade

                            $(questao).find('span')[0].id ="titulo-questao-" + numero_questao + "-questionario-" + numero_conteudo +  "-unidade-" + numero_unidade

                            $(questao).find(".resultado-questao")[0].id = "resultado-questao-" + numero_questao + "-questionario-" + numero_conteudo +  "-unidade-" + numero_unidade

                            hash2 = hash2 + 1

                            var alternativas = $(questao).find(".alternativa" );
                            var alternativa = undefined;

                            for (let l = 0; l < alternativas.length; l++){

                                alternativa = alternativas[l]
                                numero_alternativa = l + 1

                                $(alternativa).removeClass().addClass("card card-alternativa-" + numero_alternativa + "-questao-"+ numero_questao + "-questionario-" + numero_conteudo +"-unidade-"+ numero_unidade + " alternativa")

                                if($($($(questao).find('.card-header')[0]).siblings()[0]).hasClass('show')){
                                    $(alternativa)[0].getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-up"></i>Alternativa' + ' - ' +  numero_alternativa;
                                }
                                else {
                                    $(alternativa)[0].getElementsByClassName("link-conteudo")[0].innerHTML = '<i class="fas fa-angle-double-down"></i>Alternativa' + ' - ' +  numero_alternativa;
                                }

                                $(alternativa)[0].id = "alternativa-" + numero_alternativa + "-questao-"+ numero_questao + "-questionario-" + numero_conteudo +"-unidade-"+ numero_unidade

                                $(alternativa).find('i')[2].id = "elimina-alternativa-" + numero_alternativa + "-questao-"+ numero_questao + "-questionario-" + numero_conteudo +"-unidade-"+ numero_unidade

                                var form_alternativa = $(alternativa).find('form')[0]
                                var form_novo_id = "form-alternativa-" + numero_alternativa + "-questao-" + numero_questao + "-questionario-" + numero_conteudo + "-unidade-" + numero_unidade
                                if(form_alternativa.id != form_novo_id){
                                    form_alternativa.id = form_novo_id
                                    $(form_alternativa).addClass("dados-modificados")
                                }

                                $(alternativa).find('.fa-trash').attr('onclick', "removeCard" + "(this, 'alternativa', "  + $(form_alternativa).find('input[name="conteudo_id"]')[0].value + ")")

                                $(alternativa).find('input[name="unidade_ordem"]')[0].value = numero_unidade
                                $(alternativa).find('input[name="questionario_ordem"]')[0].value = numero_conteudo
                                $(alternativa).find('input[name="questao_ordem"]')[0].value = numero_questao
                                $(alternativa).find('input[name="alternativa_ordem"]')[0].value = numero_alternativa

                                $(alternativa).find('span')[0].id ="titulo-alternativa-" + numero_alternativa + "-questao-" + numero_questao + "-questionario-" + numero_conteudo +  "-unidade-" + numero_unidade

                                $(alternativa).find(".resultado-alternativa")[0].id = "resultado-alternativa-" + numero_alternativa + "-questao-" + numero_questao + "-questionario-" + numero_conteudo +  "-unidade-" + numero_unidade

                                hash3 = hash3 + 1
                            }
                        }

                    }
                }

            }
            numero_unidade = numero_unidade + 1
        }
    }

    function enviaForms(){

      var formData;

      var focused = $(':focus').blur();

      var forms_modificados = $('.dados-modificados')

      var form = forms_modificados[0]

      if(form){

          if($(form).find('input:file')[0]){

            if($(form).find('input:file').hasClass("trocou-arquivo") == false) {
              $(form).find('input:file').removeAttr("name")
            }
          }

        formData = new FormData(form);

        $('body').addClass('disabledbutton')

        $.ajax({
          url         : '/cadastro-conteudo-curso/{{ curso.id }}',
          data        : formData,
          type        : 'POST',
          processData : false,
          contentType : false,
          success     : function(data, textStatus, jqXHR){
              $(form).removeClass("dados-modificados")
              if($(form).find('input:file')[0]){
                  $(form).find('input:file').removeClass("trocou-arquivo")
              }

              if(data != "") {
                  var resposta = jQuery.parseJSON(data)

                  $(form).find('input[name="conteudo_id"]')[0].value = resposta['conteudo_id']

                  if(resposta['path_conteudo'] && resposta['path_conteudo'] != '') {
                    $(form).find('.caminho-arquivo-span')[0].innerHTML = resposta['path_conteudo']
                    $(form).find('.caminho-arquivo-span').attr('href', "/media/" + resposta['path_conteudo'])
                    $(form).find('.caminho-arquivo-span')[0].hidden = false
                  }
                  else {
                      if($(form).find('.caminho-arquivo-span')[0]) {
                          $(form).find('.caminho-arquivo-span')[0].hidden = true
                      }
                  }

                  if($(form).find('.resultado-' + resposta['conteudo_tipo'])[0]) {
                      $(form).find('.resultado-' + resposta['conteudo_tipo'])[0].innerHTML =
                      `
                          <div class="alert alert-success alert-dismissable" style="padding: 0.3rem;">
                            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times</a>
                            <strong>${resposta['resultado']}</strong>
                          </div>
                      `
                  }
              }
              organizaUnidadesConteudos()
              enviaForms()
              $('body').removeClass('disabledbutton')
              $('.modal-aguarde').modal('hide');
          },
          error: function(data){
              var errors = jQuery.parseJSON(data.responseText)
              console.log("teste")
              for (key in errors) {
                  if(document.getElementById(key)){
                        var card_unidade = $('#' + errors['unidade-selector']).find('[data-parent]')[0]
                        $(card_unidade).collapse('show')
                        document.getElementById(key).innerHTML = errors[key];

                        if(errors['conteudo_tipo'] == 'questao' || errors['conteudo_tipo'] == 'alternativa'){
                            var card_questionario = $('#' + errors['questionario-selector']).find('[data-parent]')[0]
                            $(card_questionario).collapse('show')
                        }

                        if(errors['conteudo_tipo'] == 'alternativa'){
                            var card_questao = $('#' + errors['questao-selector']).find('[data-parent]')[0]
                            $(card_questao).collapse('show')
                        }

                        if(errors['conteudo_tipo'] != 'unidade'){
                            $(document.getElementById(key)).closest("[data-parent]" ).collapse('show')
                        }

                  }
              }

              if(errors['resultado']) {
                  if($(form).find('.resultado-' + errors['conteudo_tipo'])[0]) {
                      $(form).find('.resultado-' + errors['conteudo_tipo'])[0].innerHTML =
                      `
                          <div class="alert alert-danger alert-dismissable" style="padding: 0.3rem;">
                            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times</a>
                            <strong>${errors['resultado']}</strong>
                          </div>
                      `
                  }
              }
              $('body').removeClass('disabledbutton')
              $('.modal-aguarde').modal('hide');
          }
        });

        if($(form).find('input:file')[0]){

          if($(form).find('input:file').attr('name') == undefined) {
            $(form).find('input:file').attr("name", "caminho")
          }
        }
      }
    }


    function enviaForm(event){
        event.preventDefault();
        event.stopImmediatePropagation();

        try {
            var focused = $(':focus').blur();

            var forms_modificados = $('.dados-modificados')

            var form = forms_modificados[0]
            if(form) {
                $('.modal-aguarde').modal('show');
            }
            else {
                $('.modal-sem-alteracoes').modal('show');
            }

        }
        catch (e) {
           return false;
        }

        return false;
    }


    $('.modal-aguarde').on('shown.bs.modal', function () {
        enviaForms()
    })


    function alterouDados(){
        $(this).closest("form").addClass("dados-modificados")

        if($(this).is('input[type="checkbox"]')) {

            inputs = $(this).closest('.questao').find('form').find('input[type="checkbox"]')

            for(let i = 0; i < inputs.length; i++){
                if(inputs[i] !== this) {
                    $(inputs[i]).prop('checked', false);
                }
            }
        }

        if($(this).is('input[type="radio"]')) {
            var selecao = $(this).closest('form').find('input[type="radio"]:checked')[0]

            var grupo_url = $(this).closest('form').find('.grupo-url')[0]
            var grupo_arquivo = $(this).closest('form').find('.grupo-arquivo')[0]

            if(selecao.id == "tipo-video-url") {
                grupo_url.hidden = false
                grupo_arquivo.hidden =  true
                $(grupo_arquivo).find('input[name=caminho]').removeClass('trocou-arquivo')
            }
            else {
                grupo_url.hidden = true
                grupo_arquivo.hidden =  false
            }
        }
    }


    function alterouArquivo(){
        if($(this).val() != ""){
            $(this).addClass("trocou-arquivo")
        }
    }


    $(document).on('click', '#confirmDeleteButtonModal', function () {
        id_elemento = $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("id_elemento")
        id_conteudo = $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("id_conteudo")
        classe_elemento = $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("classe_elemento")

        elemento = $('#' + id_elemento)[0]

        id_resultado = elemento.id.replace("elimina", "resultado");

        if (id_conteudo > 0) {
            $.ajax(
                {
                    type: "GET",
                    url: "/remove-conteudo-curso",
                    data: {
                        tipo_conteudo: classe_elemento,
                        conteudo_id: id_conteudo,
                        id_resultado: id_resultado,
                    },
                    success: function (data) {
                        $(elemento).parents('.' + classe_elemento).get(0).remove();
                        organizaUnidadesConteudos()

                    },
                    error: function (data) {
                        var errors = jQuery.parseJSON(data.responseText)
                        for (key in errors) {
                            document.getElementById(key).innerHTML = errors[key];

                        }
                    }
                }
            )
        }
        else {
            $(elemento).parents('.' + classe_elemento).get(0).remove();
            organizaUnidadesConteudos()
        }
    });


    function removeCard(elemento, classe_elemento, id_conteudo) {

        $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("id_elemento", elemento.id)
        $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("id_conteudo", id_conteudo)
        $("#confirmDeleteButtonModal").closest(".modal-delete-item").attr("classe_elemento", classe_elemento)

        var str = elemento.id

        str = str.split("-")

        msg = ""
        for(let i = 1; i < str.length; i++){
            msg = msg + str[i] + " "
        }

        msg = "Deseja remover o item: " + msg + "?"

        $('.confirm-delete')[0].innerHTML = "<b>" + msg + "</b>";

        $('.modal-delete-item').modal('show');

    }


    $( function() {
        $( "#accordion" ).sortable({
            stop : function(event,ui) {
                organizaUnidadesConteudos()
            }
          }
        );
    });

    function ordenaConteudo() {
        $( ".card-videos" ).sortable({
            stop : function(event,ui){
                organizaUnidadesConteudos();

            }
        });
    }

    function ordenaConteudoArquivo() {
        $( ".card-arquivos" )
        .sortable(
          {
            stop         : function(event,ui){

              organizaUnidadesConteudos();

            }
          }

        );
    }

    function ordenaConteudoQuestionario() {
        $( ".card-questionarios" ).sortable({
            stop : function(event,ui){
                organizaUnidadesConteudos();

            }
        });
    }

    function ordenaConteudoQuestao() {
        $( ".card-questoes" ).sortable({
            stop : function(event,ui){
                organizaUnidadesConteudos();

            }
        });
    }

    function ordenaConteudoAlternativa() {
        $( ".card-alternativas" ).sortable({
            stop : function(event,ui){
                organizaUnidadesConteudos();

            }
        });
    }


    function removeErro(){
        if(this && this.nextElementSibling && this.nextElementSibling.innerText){
            this.nextElementSibling.innerText=""
        }
    }

    function expandeArea(elemento){
      if($($($(elemento).closest('.card-header')).siblings()[0]).hasClass('show')){
        $($(elemento).find('.fas')[0]).removeClass("fa-angle-double-up").addClass("fa-angle-double-down");
      }
      else {
        $($(elemento).find('.fas')[0]).removeClass("fa-angle-double-down").addClass("fa-angle-double-up");
      }

    }


    $(document).ready(function() {
        $('form').on('submit', enviaForm);
        $('input').on('focus', removeErro)
        $('input').on('change', alterouDados)
        $('input:file').on('change', alterouArquivo)
        $('.card-videos').on('click', ordenaConteudo)
        $('.card-arquivos').on('click', ordenaConteudoArquivo)
        $('.card-questionarios').on('click', ordenaConteudoQuestionario)
        $('.card-questoes').on('click', ordenaConteudoQuestao)
        $('.card-alternativas').on('click', ordenaConteudoAlternativa)
        organizaUnidadesConteudos()
    });


    window.onbeforeunload = function (e) {
        e = e || window.event;

        var focused = $(':focus').blur();
        if ($('body').find('.dados-modificados')[0]){
            // For IE and Firefox prior to version 4
            if (e) {
                e.returnValue = 'Existem dados alterados não salvos. Deseja sair mesmo assim?';
            }

           // For Safari
           return 'Existem dados alterados não salvos. Deseja sair mesmo assim?';
        }
    };

   </script>
{% endblock %}